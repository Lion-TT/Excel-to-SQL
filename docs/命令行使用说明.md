# å‘½ä»¤è¡Œå‚æ•°ä½¿ç”¨è¯´æ˜

## ğŸ‰ æ–°åŠŸèƒ½ï¼šå‘½ä»¤è¡Œå‚æ•°æ”¯æŒ

ç°åœ¨æ‚¨å¯ä»¥ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šæŸ¥è¯¢åç§°å’Œå‚æ•°ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ï¼

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ç”¨æ³•

```bash
# å¯¼å‡ºæ‰€æœ‰å®¢æˆ·ä¿¡æ¯
python quick_export.py get_all_customers

# å¯¼å‡ºæ‰€æœ‰è®¢å•ä¿¡æ¯
python quick_export.py get_all_orders

# å¯¼å‡ºæ‰€æœ‰æ‹œè®¿è®°å½•
python quick_export.py get_all_visits
```

### 2. å¸¦å‚æ•°çš„æŸ¥è¯¢

```bash
# å¯¼å‡ºæŒ‡å®šæ—¶é—´æ®µçš„å®¢æˆ·
python quick_export.py get_customers_by_date_range start_date=2024-01-01 end_date=2024-06-30

# å¯¼å‡ºæŒ‡å®šæ—¶é—´æ®µçš„è®¢å•
python quick_export.py get_orders_by_date_range start_date=2024-01-01 end_date=2024-06-30

# å¯¼å‡ºå®¢æˆ·è®¢å•æ±‡æ€»ï¼ˆå¸¦é‡‘é¢é˜ˆå€¼ï¼‰
python quick_export.py get_customer_order_summary start_date=2024-01-01 end_date=2024-06-30 min_amount=1000
```

### 3. æŒ‡å®šè¾“å‡ºæ–‡ä»¶

```bash
# æŒ‡å®šè¾“å‡ºæ–‡ä»¶å
python quick_export.py get_all_customers --output æˆ‘çš„å®¢æˆ·æ•°æ®.xlsx

# æŒ‡å®šå·¥ä½œè¡¨åç§°
python quick_export.py get_all_orders --sheet è®¢å•è¡¨

# åŒæ—¶æŒ‡å®šæ–‡ä»¶åå’Œå·¥ä½œè¡¨å
python quick_export.py get_all_visits --output æ‹œè®¿è®°å½•.xlsx --sheet æ‹œè®¿æ•°æ®
```

### 4. å®Œæ•´ç¤ºä¾‹

```bash
# å¯¼å‡º2024å¹´ä¸ŠåŠå¹´çš„é«˜æ¶ˆè´¹å®¢æˆ·è®¢å•æ±‡æ€»
python quick_export.py get_customer_order_summary start_date=2024-01-01 end_date=2024-06-30 min_amount=5000 --output é«˜æ¶ˆè´¹å®¢æˆ·æ±‡æ€».xlsx --sheet å®¢æˆ·æ±‡æ€»

# å¯¼å‡ºæœˆåº¦é”€å”®ç»Ÿè®¡
python quick_export.py get_monthly_sales_stats start_date=2024-01-01 end_date=2024-12-31 --output 2024å¹´é”€å”®ç»Ÿè®¡.xlsx
```

## ğŸ“‹ å‚æ•°è¯´æ˜

### æŸ¥è¯¢åç§°
- `get_all_customers` - æ‰€æœ‰å®¢æˆ·ä¿¡æ¯
- `get_customers_by_date_range` - æŒ‰æ—¥æœŸèŒƒå›´æŸ¥è¯¢å®¢æˆ·
- `get_customer_stats_by_type` - æŒ‰ç±»å‹ç»Ÿè®¡å®¢æˆ·
- `get_high_value_customers` - é«˜ä»·å€¼å®¢æˆ·
- `get_all_orders` - æ‰€æœ‰è®¢å•ä¿¡æ¯
- `get_orders_by_date_range` - æŒ‰æ—¥æœŸèŒƒå›´æŸ¥è¯¢è®¢å•
- `get_customer_order_summary` - å®¢æˆ·è®¢å•æ±‡æ€»
- `get_monthly_sales_stats` - æœˆåº¦é”€å”®ç»Ÿè®¡
- `get_all_visits` - æ‰€æœ‰æ‹œè®¿è®°å½•
- `get_visits_by_date_range` - æŒ‰æ—¥æœŸèŒƒå›´æŸ¥è¯¢æ‹œè®¿

### å¸¸ç”¨å‚æ•°
- `start_date` - å¼€å§‹æ—¥æœŸï¼ˆæ ¼å¼ï¼š2024-01-01ï¼‰
- `end_date` - ç»“æŸæ—¥æœŸï¼ˆæ ¼å¼ï¼š2024-06-30ï¼‰
- `min_amount` - æœ€å°é‡‘é¢ï¼ˆæ•°å­—ï¼‰

### é€‰é¡¹å‚æ•°
- `--output` - æŒ‡å®šè¾“å‡ºExcelæ–‡ä»¶è·¯å¾„
- `--sheet` - æŒ‡å®šExcelå·¥ä½œè¡¨åç§°

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. æŸ¥çœ‹å¯ç”¨æŸ¥è¯¢
å¦‚æœä¸åŠ ä»»ä½•å‚æ•°ï¼Œä¼šæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æŸ¥è¯¢ï¼š
```bash
python quick_export.py
```

### 2. å‚æ•°æ ¼å¼
å‚æ•°ä½¿ç”¨ `key=value` æ ¼å¼ï¼š
```bash
python quick_export.py æŸ¥è¯¢å å‚æ•°1=å€¼1 å‚æ•°2=å€¼2
```

### 3. é»˜è®¤è¾“å‡º
å¦‚æœä¸æŒ‡å®š `--output`ï¼Œæ–‡ä»¶ä¼šä¿å­˜åˆ°ï¼š
```
E:\DOCUMENTS\inbox\new MySQL\data\exports\æŸ¥è¯¢å.xlsx
```

### 4. é»˜è®¤å·¥ä½œè¡¨å
å¦‚æœä¸æŒ‡å®š `--sheet`ï¼Œå·¥ä½œè¡¨åé»˜è®¤ä¸ºæŸ¥è¯¢åç§°ã€‚

## ğŸ”§ æ•…éšœæ’é™¤

### 1. æŸ¥è¯¢ä¸å­˜åœ¨
```bash
âŒ æŸ¥è¯¢ 'wrong_query' ä¸å­˜åœ¨æˆ–å‚æ•°é”™è¯¯
```
**è§£å†³**ï¼šæ£€æŸ¥æŸ¥è¯¢åç§°æ˜¯å¦æ­£ç¡®ï¼Œè¿è¡Œ `python quick_export.py` æŸ¥çœ‹å¯ç”¨æŸ¥è¯¢ã€‚

### 2. å‚æ•°é”™è¯¯
```bash
âŒ æŸ¥è¯¢å‚æ•°ç¼ºå¤±: start_date
```
**è§£å†³**ï¼šæ£€æŸ¥å‚æ•°åç§°æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿ä½¿ç”¨ `key=value` æ ¼å¼ã€‚

### 3. è¾“å‡ºè·¯å¾„é”™è¯¯
```bash
âŒ å¯¼å‡ºå¤±è´¥: [Errno 2] No such file or directory
```
**è§£å†³**ï¼šç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨ï¼Œæˆ–ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚

## ğŸ“ å®é™…ä½¿ç”¨ç¤ºä¾‹

### æ—¥å¸¸æ•°æ®å¯¼å‡º
```bash
# æ¯æ—¥å®¢æˆ·æ•°æ®
python quick_export.py get_all_customers --output æ¯æ—¥å®¢æˆ·æ•°æ®.xlsx

# æœ¬å‘¨è®¢å•æ±‡æ€»
python quick_export.py get_orders_by_date_range start_date=2024-06-24 end_date=2024-06-30 --output æœ¬å‘¨è®¢å•.xlsx

# æœ¬æœˆæ‹œè®¿ç»Ÿè®¡
python quick_export.py get_monthly_visit_stats start_date=2024-06-01 end_date=2024-06-30 --output æœ¬æœˆæ‹œè®¿ç»Ÿè®¡.xlsx
```

### å®šæœŸæŠ¥å‘Š
```bash
# æœˆåº¦é”€å”®æŠ¥å‘Š
python quick_export.py get_monthly_sales_stats start_date=2024-06-01 end_date=2024-06-30 --output 6æœˆé”€å”®æŠ¥å‘Š.xlsx --sheet é”€å”®ç»Ÿè®¡

# å®¢æˆ·ä»·å€¼åˆ†æ
python quick_export.py get_customer_order_summary start_date=2024-01-01 end_date=2024-06-30 min_amount=10000 --output é«˜ä»·å€¼å®¢æˆ·åˆ†æ.xlsx
```

## ğŸ¯ ä¼˜åŠ¿

1. **æ— éœ€ä¿®æ”¹ä»£ç ** - ç›´æ¥å‘½ä»¤è¡Œè°ƒç”¨
2. **çµæ´»å‚æ•°** - æ”¯æŒå„ç§æŸ¥è¯¢å‚æ•°
3. **è‡ªå®šä¹‰è¾“å‡º** - å¯æŒ‡å®šæ–‡ä»¶åå’Œå·¥ä½œè¡¨å
4. **æ‰¹é‡æ“ä½œ** - å¯ç¼–å†™æ‰¹å¤„ç†è„šæœ¬
5. **è‡ªåŠ¨åŒ–å‹å¥½** - é€‚åˆå®šæ—¶ä»»åŠ¡å’Œè„šæœ¬è°ƒç”¨

---

**ç°åœ¨æ‚¨å¯ä»¥åƒä½¿ç”¨ `python -m src.db.db_importer visit_record` ä¸€æ ·ä½¿ç”¨å¯¼å‡ºåŠŸèƒ½äº†ï¼** ğŸ‰ 